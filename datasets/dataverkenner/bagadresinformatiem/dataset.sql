CREATE MATERIALIZED VIEW IF NOT EXISTS public.dataverkenner_bagadresinformatiem_bagadresinformatie_v1 as
select
bag_nummeraanduidingen_v1.id as "id",
bag_nummeraanduidingen_v1.identificatie as "identificatie",
bag_nummeraanduidingen_v1.volgnummer as "volgnummer",
bag_nummeraanduidingen_v1.huisnummer as "huisnummer",
bag_nummeraanduidingen_v1.huisletter as "huisletter",
bag_nummeraanduidingen_v1.huisnummertoevoeging as "huisnummertoevoeging",
bag_nummeraanduidingen_v1.postcode as "postcode",
bag_nummeraanduidingen_v1.type_adresseerbaar_object_omschrijving as "type_adresseerbaar_object_omschrijving",
bag_nummeraanduidingen_v1.type_adres as "type_adres",
bag_nummeraanduidingen_v1.adresseert_verblijfsobject_identificatie as "adresseert_verblijfsobject_identificatie",
bag_nummeraanduidingen_v1.begin_geldigheid as "begin_geldigheid",
bag_nummeraanduidingen_v1.documentdatum as "documentdatum",
bag_nummeraanduidingen_v1.documentnummer as "documentnummer",
bag_nummeraanduidingen_v1.eind_geldigheid as "eind_geldigheid",
bag_openbareruimtes_v1.identificatie as "openbareruimte_identificatie",
bag_openbareruimtes_v1.volgnummer as "openbareruimte_volgnummer",
bag_openbareruimtes_v1.type_omschrijving as "openbareruimte_type_omschrijving",
bag_openbareruimtes_v1.naam as "openbareruimte_naam",
bag_woonplaatsen_v1.identificatie as "woonplaats_identificatie",
bag_woonplaatsen_v1.volgnummer as "woonplaats_volgnummer",
bag_woonplaatsen_v1.naam as "woonplaats_naam",
bag_verblijfsobjecten_v1.id as "verblijfsobject_id",
bag_verblijfsobjecten_v1.identificatie as "verblijfsobject_identificatie",
bag_verblijfsobjecten_v1.volgnummer as "verblijfsobject_volgnummer",
bag_verblijfsobjecten_v1.geconstateerd as "verblijfsobject_geconstateerd",
bag_verblijfsobjecten_v1.geometrie as "verblijfsobject_geometrie",
bag_verblijfsobjecten_v1.oppervlakte as "verblijfsobject_oppervlakte",
bag_verblijfsobjecten_v1.status_omschrijving as "verblijfsobject_status_omschrijving",
bag_verblijfsobjecten_v1.gebruiksdoel_woonfunctie_omschrijving as "verblijfsobject_gebruiksdoel_woonfunctie_omschrijving",
bag_verblijfsobjecten_v1.gebruiksdoel_gezondheidszorgfunctie_omschrijving as "verblijfsobject_gebruiksdoel_gezondheidszorgfunctie",
bag_verblijfsobjecten_v1.aantal_eenheden_complex as "verblijfsobject_aantal_eenheden_complex",
bag_verblijfsobjecten_v1.verdieping_toegang as "verblijfsobject_verdieping_toegang",
bag_verblijfsobjecten_v1.aantal_bouwlagen as "verblijfsobject_aantal_bouwlagen",
bag_verblijfsobjecten_v1.hoogste_bouwlaag as "verblijfsobject_hoogste_bouwlaag",
bag_verblijfsobjecten_v1.laagste_bouwlaag as "verblijfsobject_laagste_bouwlaag",
bag_verblijfsobjecten_v1.aantal_kamers as "verblijfsobject_aantal_kamers",
bag_verblijfsobjecten_v1.eigendomsverhouding_omschrijving as "verblijfsobject_eigendomsverhouding_omschrijving",
bag_verblijfsobjecten_v1.feitelijk_gebruik_omschrijving as "verblijfsobject_feitelijk_gebruik_omschrijving",
bag_verblijfsobjecten_v1.redenopvoer_omschrijving as "verblijfsobject_redenopvoer_omschrijving",
bag_verblijfsobjecten_v1.redenafvoer_omschrijving as "verblijfsobject_redenafvoer_omschrijving",
bag_onderzoeken_v1.object_identificatie as "onderzoeken_object_identificatie",
bag_verblijfsobjecten_v1.documentdatum as "verblijfsobject_documentdatum",
bag_verblijfsobjecten_v1.documentnummer as "verblijfsobject_documentnummer",
bag_verblijfsobjecten_v1.begin_geldigheid as "verblijfsobject_begin_geldigheid",
bag_verblijfsobjecten_v1.eind_geldigheid as "verblijfsobject_eind_geldigheid",
bag_onderzoeken_v1.volgnummer as "onderzoeken_volgnummer",
bag_onderzoeken_v1.in_onderzoek as "onderzoeken_in_onderzoek",
bag_onderzoeken_v1.begin_geldigheid as "onderzoeken_begin_geldigheid",
bag_onderzoeken_v1.eind_geldigheid as "onderzoeken_eind_geldigheid",
bag_ligplaatsen_v1.identificatie as "ligplaats_identificatie",
bag_ligplaatsen_v1.volgnummer as "ligplaats_volgnummer",
bag_ligplaatsen_v1.geconstateerd as "ligplaats_geconstateerd",
bag_ligplaatsen_v1.status_omschrijving as "ligplaats_status_omschrijving",
bag_ligplaatsen_v1.geometrie as "ligplaats_geometrie",
bag_ligplaatsen_v1.begin_geldigheid as "ligplaats_begin_geldigheid",
bag_ligplaatsen_v1.eind_geldigheid as "ligplaats_eind_geldigheid",
bag_ligplaatsen_v1.documentdatum as "ligplaats_documentdatum",
bag_ligplaatsen_v1.documentnummer as "ligplaats_documentnummer",
bag_standplaatsen_v1.identificatie as "standplaats_identificatie",
bag_standplaatsen_v1.volgnummer as "standplaats_volgnummer",
bag_standplaatsen_v1.geconstateerd as "standplaats_geconstateerd",
bag_standplaatsen_v1.status_omschrijving as "standplaats_status_omschrijving",
bag_standplaatsen_v1.geometrie as "standplaats_geometrie",
bag_standplaatsen_v1.begin_geldigheid as "standplaats_begin_geldigheid",
bag_standplaatsen_v1.eind_geldigheid as "standplaats_eind_geldigheid",
bag_standplaatsen_v1.documentdatum as "standplaats_documentdatum",
bag_standplaatsen_v1.documentnummer as "standplaats_documentnummer",
gebieden_buurten_v1.identificatie as "gebieden_buurt_identificatie",
gebieden_buurten_v1.volgnummer as "gebieden_buurt_volgnummer",
gebieden_buurten_v1.naam as "gebieden_buurt_naam",
gebieden_buurten_v1.code as "gebieden_buurt_code",
gebieden_wijken_v1.identificatie as "gebieden_wijk_identificatie",
gebieden_wijken_v1.volgnummer as "gebieden_wijk_volgnummer",
gebieden_wijken_v1.naam as "gebieden_wijk_naam",
gebieden_wijken_v1.code as "gebieden_wijk_code",
gebieden_stadsdelen_v1.identificatie as "gebieden_stadsdeel_identificatie",
gebieden_stadsdelen_v1.volgnummer as "gebieden_stadsdeel_volgnummer",
gebieden_stadsdelen_v1.naam as "gebieden_stadsdeel_naam",
gebieden_stadsdelen_v1.code as "gebieden_stadsdeel_code",
gebieden_ggwgebieden_v1.identificatie as "gebieden_ggwgebied_identificatie",
gebieden_ggwgebieden_v1.volgnummer as "gebieden_ggwgebied_volgnummer",
gebieden_ggwgebieden_v1.naam as "gebieden_ggwgebied_naam",
gebieden_ggwgebieden_v1.code as "gebieden_ggwgebied_code",
gebieden_bouwblokken_v1.identificatie as "gebieden_bouwblok_identificatie",
gebieden_bouwblokken_v1.volgnummer as "gebieden_bouwblok_volgnummer",
gebieden_bouwblokken_v1.code as "gebieden_bouwblok_code",
bag_panden_v1.identificatie as "pand_identificatie",
bag_panden_v1.volgnummer as "pand_volgnummer",
bag_verblijfsobjecten_gebruiksdoel_v1.omschrijving as "gebruiksdoel_omschrijving",
bag_verblijfsobjecten_toegang_v1.omschrijving as "toegang_omschrijving"
from bag_nummeraanduidingen_v1
left join bag_openbareruimtes_v1 on bag_nummeraanduidingen_v1.ligt_aan_openbareruimte_id = bag_openbareruimtes_v1.id
left join bag_woonplaatsen_v1 on bag_nummeraanduidingen_v1.ligt_in_woonplaats_id = bag_woonplaatsen_v1.id
left join bag_verblijfsobjecten_v1 on bag_nummeraanduidingen_v1.adresseert_verblijfsobject_id=bag_verblijfsobjecten_v1.id
left join bag_ligplaatsen_v1 on bag_nummeraanduidingen_v1.adresseert_ligplaats_id = bag_ligplaatsen_v1.id
left join bag_standplaatsen_v1 on bag_nummeraanduidingen_v1.adresseert_standplaats_id = bag_standplaatsen_v1.id
left join bag_onderzoeken_v1 on bag_verblijfsobjecten_v1.identificatie = bag_onderzoeken_v1.object_identificatie
OR bag_standplaatsen_v1.identificatie = bag_onderzoeken_v1.object_identificatie
OR bag_ligplaatsen_v1.identificatie = bag_onderzoeken_v1.object_identificatie
left join gebieden_buurten_v1 on bag_verblijfsobjecten_v1.ligt_in_buurt_id=gebieden_buurten_v1.id
OR bag_standplaatsen_v1.ligt_in_buurt_id = gebieden_buurten_v1.id
OR bag_ligplaatsen_v1.ligt_in_buurt_id = gebieden_buurten_v1.id
left join gebieden_wijken_v1 on gebieden_buurten_v1.ligt_in_wijk_id = gebieden_wijken_v1.id
left join gebieden_stadsdelen_v1 on gebieden_wijken_v1.ligt_in_stadsdeel_id = gebieden_stadsdelen_v1.id
left join gebieden_ggwgebieden_v1 on gebieden_buurten_v1.ligt_in_ggwgebied_id = gebieden_ggwgebieden_v1.id
left join bag_verblijfsobjecten_ligt_in_panden_v1 on bag_verblijfsobjecten_v1.id = bag_verblijfsobjecten_ligt_in_panden_v1.verblijfsobjecten_id
left join bag_panden_v1 on bag_panden_v1.id = bag_verblijfsobjecten_ligt_in_panden_v1.ligt_in_panden_id
left join gebieden_bouwblokken_v1 on bag_panden_v1.ligt_in_bouwblok_id=gebieden_bouwblokken_v1.id
left join bag_verblijfsobjecten_gebruiksdoel_v1 on bag_nummeraanduidingen_v1.adresseert_verblijfsobject_id=bag_verblijfsobjecten_gebruiksdoel_v1.parent_id
left join bag_verblijfsobjecten_toegang_v1 on bag_nummeraanduidingen_v1.adresseert_verblijfsobject_id=bag_verblijfsobjecten_toegang_v1.parent_id with no data;

SELECT cron.schedule('dataverkenner_bagadresinformatiem_bagadresinformatie_refresh', '30 22 * * *', 'REFRESH MATERIALIZED VIEW public.dataverkenner_bagadresinformatiem_bagadresinformatie_v1');
